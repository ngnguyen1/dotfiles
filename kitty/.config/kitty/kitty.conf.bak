# ============================================================================
# Reset default mapping
# ============================================================================
map ctrl+shift+l no_op
map ctrl+shift+h no_op

# ============================================================================
# TERMINAL SETTINGS
# ============================================================================
term xterm-256color
shell_integration no-cursor

# ============================================================================
# MACOS SPECIFIC
# ============================================================================
macos_option_as_alt yes
hide_window_decorations yes

# ============================================================================
# PERFORMANCE & MEMORY
# ============================================================================
scrollback_lines 50000
scrollback_pager_history_size 50
scrollback_fill_enlarged_window yes
input_delay 3
repaint_delay 10
sync_to_monitor yes

# ============================================================================
# CURSOR
# ============================================================================
cursor_shape underline
cursor_blink_interval 0.5
cursor_stop_blinking_after 15.0

# ============================================================================
# MOUSE
# ============================================================================
mouse_hide_wait 3.0
url_style curly
open_url_with default
detect_urls yes
copy_on_select clipboard

# ============================================================================
# CLIPBOARD
# ============================================================================
clipboard_control write-clipboard write-primary read-clipboard read-primary
clipboard_max_size 512

# ============================================================================
# WINDOW & LAYOUT
# ============================================================================
enabled_layouts splits,stack,tall,fat,grid
window_padding_width 5
window_margin_width 10
single_window_margin_width 0
remember_window_size yes
initial_window_width 1400
initial_window_height 900
# background_image ~/.config/kitty/images/tahoebg.jpg
# background_image_layout scaled
# background_tint 0.9
window_border_width 2pt
inactive_text_alpha 0.5
# background_tint_gaps -10

# ============================================================================
# TABS
# ============================================================================
tab_bar_edge top
tab_bar_align left
tab_bar_style custom
tab_bar_min_tabs 1
tab_activity_symbol none
bell_on_tab no
tab_separator ""
tab_bar_margin_width 0.0
tab_bar_margin_height 0.0 0.0
tab_title_template "{f'{title[:30]}â€¦' if title.rindex(title[-1]) + 1 > 30 else (title.center(6) if (title.rindex(title[-1]) + 1) % 2 == 0 else title.center(5))}"
# tab_bar_filter session:~ or session:^$
active_tab_font_style bold

# ============================================================================
# FONTS
# ============================================================================
font_family      family="0xProto Nerd Font Mono"
font_size        16.0
bold_font        auto
italic_font      auto
bold_italic_font auto
adjust_line_height 0
adjust_column_width 0
disable_ligatures never

# ============================================================================
# THEME
# ============================================================================
# include themes/tokyo-night.moon.conf
include themes/catppuccin-mocha.conf

# ============================================================================
# KEYMAPS
# ============================================================================

# Font size
map cmd+plus change_font_size all +2.0
map cmd+minus change_font_size all -2.0
map cmd+equal change_font_size all 0

# --- Tabs ---
map cmd+t         new_tab_with_cwd
map cmd+shift+w   close_tab
# map ctrl+tab    goto_tab -1

# --- Windows: Create / Close ---
map cmd+d         launch --location=vsplit --cwd=current
map cmd+shift+d   launch --location=hsplit --cwd=current
map cmd+w         close_window

# Smart split creation
map f4            launch --location=split
map f5            launch --location=hsplit
map f6            launch --location=vsplit

# Rotate split orientation
# map f7            layout_action rotate

# --- Windows: Navigation (vim-kitty-navigator) ---
map ctrl+shift+h  kitten pass_keys.py left   ctrl+shift+h
map ctrl+shift+j  kitten pass_keys.py bottom ctrl+shift+j
map ctrl+shift+k  kitten pass_keys.py top    ctrl+shift+k
map ctrl+shift+l  kitten pass_keys.py right  ctrl+shift+l


# --- Windows: Move position ---
map shift+up      move_window up
map shift+down    move_window down
map shift+left    move_window left
map shift+right   move_window right

# Move to screen edge
map ctrl+shift+up     layout_action move_to_screen_edge top
map ctrl+shift+down   layout_action move_to_screen_edge bottom
map ctrl+shift+left   layout_action move_to_screen_edge left
map ctrl+shift+right  layout_action move_to_screen_edge right

# --- Windows: Resize (smart-split.nvim integration) ---
map alt+up        kitten relative_resize.py up 5
map alt+down      kitten relative_resize.py down 5
map alt+left      kitten relative_resize.py left 5
map alt+right     kitten relative_resize.py right 5

# When Neovim is focused, pass resize keys to Neovim
map --when-focus-on var:IS_NVIM alt+up
map --when-focus-on var:IS_NVIM alt+down
map --when-focus-on var:IS_NVIM alt+left
map --when-focus-on var:IS_NVIM alt+right

# --- Layouts ---
map cmd+l         next_layout
map cmd+shift+l   last_used_layout

# Scrollback & search
map ctrl+shift+alt+h launch --type=overlay --stdin-source=@screen_scrollback /usr/bin/vim -c 'set clipboard=unnamed' -c 'set buftype=nofile' -c 'nnoremap <buffer> q :q<CR>' -c 'set nonumber norelativenumber' -c 'normal! G' -
map ctrl+f launch --type=overlay --stdin-source=@screen_scrollback /opt/homebrew/bin/fzf --no-sort --no-mouse --exact -i

# Hints (url, path, line, hash)
map cmd+shift+e kitten hints --type=linenum --linenum-action=tab nvim +{line} {path}
map cmd+shift+p kitten hints --type=path --program=@
map cmd+shift+u kitten hints --type=url

# Misc
map cmd+shift+r load_config_file
map cmd+shift+/ show_kitty_doc overview
map ctrl+f2 show_kitty_doc conf



# Set the bias of the split containing the currently focused window. The
# currently focused window will take up the specified percent of its parent
# window's size.
map ctrl+. layout_action bias 80

## SESSION
map f2 close_session
# Press F7 and then c to jump to the "cm" project
map f7>c>m goto_session ~/.config/kitty/sessions/cm.kitty-session
# Press F7 and then h to jump to the "hot" project
map f7>s goto_session ~/.config/kitty/sessions/suds.kitty-session
# Same as above, but the sessions are listed alphabetically instead of by most recent
map f7>/ goto_session --sort-by=alphabetical
# Browse session files inside a directory and pick one
map f7>p goto_session --sort-by=alphabetical ~/.config/kitty/sessions
# Go to the previously active session (larger negative numbers jump further back in history)
map f7>- goto_session -1

# ============================================================================
# ADVANCED
# ============================================================================
allow_remote_control yes
listen_on unix:/tmp/kitty
update_check_interval 0
confirm_os_window_close 1

